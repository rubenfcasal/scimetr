{
    "collab_server" : "",
    "contents" : "#' ---\n#' title: \"Indicadores IUNE SUG\"\n#' author: \"Grupo rankings UDC\"\n#' date: \"`r as.character(Sys.Date())`\"\n#'\n#' output:\n#'   html_document:\n#'      toc: true\n#'      toc_float: true\n#'   word_document:\n#'      toc: true\n#' ---\n#+ spin, include=FALSE, eval= FALSE\n# Este informe puede crearse en RStudio pulsando en el botón 'Compile Report'\n# o en R con el siguiente comando:\n\n# library(rmarkdown)\n# browseURL(url = render(knitr::spin('rwos_UDC_Biblio2.R', knit = FALSE)))\n\n\n#+ setup, include = FALSE\nknitr::opts_chunk$set(comment=NA, prompt=TRUE, echo = FALSE)\n# setwd(\"Z:\\\\R\\\\WoS_UDC\")\n\n# Cargar paquete\nlibrary(rwos)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(tidyr)\n\n\n\n# Cargar\nload('wos_udc_jcr.RData')\nload('wos_usc_jcr.RData')\nload('wos_uvigo_jcr.RData')\n\n# Summaries\nres_udc <- summary(db)\nres2_udc <- summary_year(db)\n\nres_usc <- summary(db_usc)\nres2_usc <- summary_year(db_usc)\n\nres_uvigo <- summary(db_uvigo)\nres2_uvigo <- summary_year(db_uvigo)\n\n\ndocs.ano <- rownames(res2_udc$Doc.PY)\n\n\n#' -------------------------------------\n#'\n#' # Profesorado\n#' ##  Profesores por año\nn.prof_udc <- c(837, 850, 851, 850, 901, 907, 914, 964, 983, 941, 930, 928)\nnames(n.prof_udc) <- 2005:2016\nn.prof_usc <- c(1540, 1489, 1590, 1589, 1646, 1695, 1720, 1677, 1655, 1612, 1574)\nnames(n.prof_usc) <- 2005:2015\nn.prof_uvigo <- c(944, 897, 928, 942, 1014, 1027, 1064, 1055, 1071, 1067, 1053)\nnames(n.prof_uvigo) <- 2005:2015\n\nn.prof <- rbind(n.prof_udc[docs.ano], n.prof_usc[docs.ano], n.prof_uvigo[docs.ano])\nrownames(n.prof) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(n.prof)\n\n\n#' -------------------------------------\n#'\n#' # Produccion-Productividade\n#' ##  Producción científica anual\n\nn.ano <- cbind(res2_udc$Doc.PY, res2_usc$Doc.PY, res2_uvigo$Doc.PY)\ncolnames(n.ano) <- c(\"UDC\", \"USC\", \"UVIGO\")\nkable(t(n.ano))\n\nDoc.PY <- data.frame(n.ano, year = rownames(n.ano)) %>%\n  gather(univ, n.ano, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(Doc.PY, aes(x = year, y = n.ano, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Scientific Production\")\n\n#' ##  Produccion científica anual por profesor\ndocs.pa <- t(n.ano)/n.prof\nkable(round(docs.pa, 2))\n\nDoc.PA <- data.frame(t(docs.pa), year = colnames(t(n.ano))) %>%\n  gather(univ, n.ano, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(Doc.PA, aes(x = year, y = n.ano, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Scientific Production per Author\")\n\n\n#' -------------------------------------\n#'\n#' # Colaboración\n#' ##  Índice de coautoria\n\nAuDoc.PY <- cbind(res2_udc$AuDoc.PY[,2], res2_usc$AuDoc.PY[,2], res2_uvigo$AuDoc.PY[,2])\nrownames(AuDoc.PY) <- docs.ano\ncolnames(AuDoc.PY) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(t(AuDoc.PY), digits = 2)\n\naudoc.py <- data.frame(AuDoc.PY, year = rownames(AuDoc.PY)) %>%\n  gather(univ, AuDoc.PY, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(audoc.py, aes(x = year, y = AuDoc.PY, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Authors per Document\")\n\n\n# ##  Documentos en colaboración nacional (pendiente)\n\n#' ##  Documentos en colaboración internacional\n\niadd_udc <- get.idAddresses(db, Country != \"Spain\")\nidd_udc <- get.idDocs(db, idAddresses = iadd_udc)\n\niadd_usc <- get.idAddresses(db_usc, Country != \"Spain\")\nidd_usc <- get.idDocs(db_usc, idAddresses = iadd_usc)\n\niadd_uvigo <- get.idAddresses(db_uvigo, Country != \"Spain\")\nidd_uvigo <- get.idDocs(db_uvigo, idAddresses = iadd_uvigo)\n\nni.ano_udc <- t(table(db$Docs$PY[idd_udc]))\nni.ano_usc <- t(table(db_usc$Docs$PY[idd_usc]))\nni.ano_uvigo <- t(table(db_uvigo$Docs$PY[idd_uvigo]))\n\nni.ano <- rbind(ni.ano_udc, ni.ano_usc, ni.ano_uvigo)\nrownames(ni.ano) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(ni.ano)\n\n\nColInt <- data.frame(t(ni.ano), year = colnames(ni.ano)) %>%\n  gather(univ, ni.ano, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(ColInt, aes(x = year, y = ni.ano, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"International Collaboration\")\n\n\n\n#' -------------------------------------\n#'\n#' # Impacto na investigación\n#' ##  Citas recibidas\n# TC\tNúmero de veces citado de la Colección principal de Web of Science\n\nTC.PY <- cbind(res2_udc$TC.PY[,2], res2_usc$TC.PY[,2], res2_uvigo$TC.PY[,2])\nrownames(TC.PY) <- docs.ano\ncolnames(TC.PY) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(t(TC.PY), digits = 2)\n\ntc.py <- data.frame(TC.PY, year = rownames(TC.PY)) %>%\n  gather(univ, TC.PY, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(tc.py, aes(x = year, y = TC.PY, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Times Cited\")\n\n\n\n#' ##  Citas por profesor\nTC.AU <- TC.PY / t(n.prof)\nkable(t(TC.AU), digits = 2)\n\ntc.au <- data.frame(TC.AU, year = rownames(TC.AU)) %>%\n  gather(univ, TC.AU, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(tc.au, aes(x = year, y = TC.AU, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Times Cited per Author\")\n\n\n#' ###  Porcentaxe de documentos non citados\ncitas0_udc <- db$Docs %>% filter(TC==0) %>% count(PY)\ncitas0_udc$n <- 100*citas0_udc$n/drop(n.ano[,1])\n\ncitas0_usc <- db_usc$Docs %>% filter(TC==0) %>% count(PY)\ncitas0_usc$n <- 100*citas0_usc$n/drop(n.ano[,2])\n\ncitas0_uvigo <- db_uvigo$Docs %>% filter(TC==0) %>% count(PY)\ncitas0_uvigo$n <- 100*citas0_uvigo$n/drop(n.ano[,3])\n\nTC.0 <- cbind(citas0_udc[-1], citas0_usc[-1], citas0_uvigo[-1])\nrownames(TC.0) <- docs.ano\ncolnames(TC.0) <- c(\"UDC\",\"USC\",\"UVIGO\")\n\nkable(t(TC.0), digits = 2)\n\ntc.0 <- data.frame(TC.0, year = rownames(TC.0)) %>%\n  gather(univ, TC.0, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(tc.0, aes(x = year, y = TC.0, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Non-Cited Documents\")\n\n\n\n#' -------------------------------------\n#'\n#' # Visibilidade\n#' ##  Publicacións en revistas do primeiro cuartil\n#' ### Totais\np.q1_udc <- with(db$Docs, table(PY[Mellor.Cuartil == \"Q1\"]))\ntotp_udc <- with(db$Docs, table(PY[!is.na(Mellor.Cuartil)]))\n\np.q1_usc <- with(db_usc$Docs, table(PY[Mellor.Cuartil == \"Q1\"]))\ntotp_usc <- with(db_usc$Docs, table(PY[!is.na(Mellor.Cuartil)]))\n\np.q1_uvigo <- with(db_uvigo$Docs, table(PY[Mellor.Cuartil == \"Q1\"]))\ntotp_uvigo <- with(db_uvigo$Docs, table(PY[!is.na(Mellor.Cuartil)]))\n\n\npq1 <- cbind(p.q1_udc, p.q1_usc, p.q1_uvigo)\ncolnames(pq1) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(t(pq1))\n\n#' ### Proporcións\ntotp.prop  <- pq1/cbind(totp_udc, totp_usc, totp_uvigo)*100\nkable(t(totp.prop),digits=2)\n\np.q1 <- data.frame(pq1, year = rownames(pq1)) %>%\n  gather(univ, pq1, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(p.q1, aes(x = year, y = pq1, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"Q1 Publications\")\n\n\n\n\n#' ##  Publicacións nas tres primeiras revistas de cada unha das áreas científicas\n#' ### Totais\n# Publicaciones en tres primeras revistas\n\np.3_udc <- with(db$Docs, table(PY[Posición.na.Discip2 < 4]))\np.3_usc <- with(db_usc$Docs, table(PY[Posición.na.Discip2 < 4]))\np.3_uvigo <- with(db_uvigo$Docs, table(PY[Posición.na.Discip2 < 4]))\n\np3 <- cbind(p.3_udc, p.3_usc, p.3_uvigo)\ncolnames(p3) <- c(\"UDC\", \"USC\", \"UVIGO\")\n\nkable(t(p3))\n\n#' ### Proporcións\ntotp.prop  <- p3/cbind(totp_udc, totp_usc, totp_uvigo)*100\nkable(t(totp.prop),digits=2)\n\n\np.3 <- data.frame(p3, year = rownames(p3)) %>%\n  gather(univ, p3, 1:3) %>%\n  mutate(year = factor(year), univ = factor(univ))\nggplot(p.3, aes(x = year, y = p3, group = univ)) +\n  geom_line(aes(col = univ), size=1.3) +\n  scale_color_manual(values=c(\"deeppink1\", \"blue2\", \"green4\")) +\n  labs(x = \"Year\", y = \"Documents\", col = \"University\") +\n  ggtitle(\"First Three Journals Publications\")\n\n\n\n\n\n#' -------------------------------------\n\n",
    "created" : 1513759685294.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1478860235",
    "id" : "BF6B2F31",
    "lastKnownWriteTime" : 1513759705,
    "last_content_update" : 1513759705295,
    "path" : "C:/Users/Borja/Dropbox/_Rankings/rwos_sug/rwos_sug.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 5,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}