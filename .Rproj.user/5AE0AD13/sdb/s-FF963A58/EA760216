{
    "collab_server" : "",
    "contents" : "#' ---\n#' title: \"Indicadores IUNE UDC Datos Biblioteca\"\n#' author: \"Grupo rankings UDC\"\n#' date: \"`r as.character(Sys.Date())`\"\n#'\n#' output:\n#'   html_document:\n#'      toc: true\n#'      toc_float: true\n#'   word_document:\n#'      toc: true\n#' ---\n#+ spin, include=FALSE, eval= FALSE\n# Este informe puede crearse en RStudio pulsando en el botón 'Compile Report'\n# o en R con el siguiente comando:\n\n# library(rmarkdown)\n# browseURL(url = render(knitr::spin('rwos_UDC_Biblio2.R', knit = FALSE)))\n\n\n#+ setup, include = FALSE\nknitr::opts_chunk$set(comment=NA, prompt=TRUE, echo = FALSE)\n# setwd(\"Z:\\\\R\\\\WoS_UDC\")\n# Cargar paquete\nlibrary(rwos)\nlibrary(knitr)\nlibrary(dplyr)\nlibrary(ggplot2)\n\n#+ datos, echo = FALSE\n## FICHERO EXCEL\nlibrary(openxlsx)\nwosdf <- readWorkbook('Registros_WOS_IUNE_2007_2016.xlsx')\nUT.biblio <- wosdf$UT\n#\n## FICHERO WOS OG = Universidade da Coruna\n#wosdf <- wos_ImportSources('../WoS/txt', other = FALSE)\n#index <- match(wosdf$UT, UT.biblio)\n## sum(!is.na(index)) 4874\n#wosdf <- wosdf[!is.na(index), ]\n#\n## FICHERO WOS noudc\n#wosdf2 <- wos_ImportSources('txtnoudc', 'savedrecs2.txt', other = FALSE)\n#wosdf <- rbind(wosdf, wosdf2)\n#\n#\n#\n#db <- wos_CreateDB(wosdf)\n#db\n#summary(db)\n#save(db, file = 'wos_udc.RData')\n\n#' -------------------------------------\n#'\n#' # Datos\n\n# load('wos_udc.RData')\n# summary(db)\n#\n# # Añadir información JCR a wos.db\n# wos_AddJCR <- function(db, jcr.list) {\n#   docs.ano <- as.numeric(names(table(db$Docs$PY)))\n#   stopifnot(all(docs.ano %in% names(jcr.list)))\n#   db$Docs$Mellor.Cuartil <- NA_character_\n#   db$Docs$Mellor.Disciplina <- NA_character_\n#   db$Docs$Posición.na.Discip. <- NA_character_\n#   db$Docs$Posición.na.Discip2 <- NA\n#   docs.issn <- db$Journals$SN[db$Docs$idj]\n#   docs.Journal.ISI <- db$Journals$J9[db$Docs$idj]\n#   for (i in seq_along(docs.ano)) { # i <- 0; i <- i + 1\n#     ind.ano <- which(db$Docs$PY == docs.ano[i])\n#     jcr.docs <- jcr.list[[as.character(docs.ano[i])]]\n#     ind.ISSN <- match(docs.issn[ind.ano], jcr.docs$ISSN)\n#     ind.journal <- match(docs.Journal.ISI[ind.ano], jcr.docs$Titulo.Curto.ISI)\n#     ind.jcr <- ifelse(!is.na(ind.ISSN), ind.ISSN, ind.journal)\n#     # ind.jcr <- ifelse(is.na(ind.journal), ind.ISSN, ind.journal)\n#     cat('\\nAno', docs.ano[i],'\\n NAs journal:', sum(is.na(ind.journal)), ', NAs ISSN:', sum(is.na(ind.ISSN)), '\\n')\n#     error0 <- which(ind.journal != ind.ISSN)\n#     if (length(error0)) cat(' Incoherencia JCR ', docs.ano[i], ':\\n', ind.ano[error0], '\\n')\n#     error1 <- setdiff(which(is.na(ind.journal)), which(is.na(ind.ISSN)))\n#     if (length(error1)) cat(' Diferencias clasif ', docs.ano[i], ':', ind.ano[error1], '\\n')\n#     db$Docs$Mellor.Cuartil[ind.ano] <- jcr.docs$Mellor.Cuartil[ind.jcr]\n#     db$Docs$Mellor.Disciplina[ind.ano] <- jcr.docs$Mellor.Disciplina[ind.jcr]\n#     db$Docs$Posición.na.Discip.[ind.ano] <- jcr.docs$Posición.na.Discip.[ind.jcr]\n#   }\n#   db$Docs$Posición.na.Discip2 <- as.numeric(substr(db$Docs$Posición.na.Discip., 1, regexpr('º', db$Docs$Posición.na.Discip.) - 1 ))\n#   return(db)\n# }\n#\n#\n# load(\"../JCR/jcr.list.RData\")\n# db <- wos_AddJCR(db, jcr.list)\n#\n# save(db, file = 'wos_udc_jcr.RData')\n#\n\nload('wos_udc_jcr.RData')\nres <- summary(db)\nres\n\nres2 <- summary_year(db)\n# res2\n\ndocs.ano <- rownames(res2$Doc.PY)\n\n#' -------------------------------------\n#'\n#' # Profesorado\n#' ##  Profesores por año\n\nn.prof <- c(837, 850, 851, 850, 901, 907, 914, 964, 983, 941, 930, 928)\nnames(n.prof) <- 2005:2016\nn.prof <- n.prof[docs.ano]\nkable(t(n.prof))\n\n#' -------------------------------------\n#'\n#' # Produccion-Productividade\n#' ##  Producción científica anual\n\nn.ano <- res2$Doc.PY\nkable(t(n.ano))\n\nplot(res2, 1)\n\n#' ##  Produccion científica anual por profesor\nkable(t(round(n.ano/n.prof, 2)))\n\nDoc.PY <- data.frame(Types = factor(rownames(res2$Doc.PY)), Documents = res2$Doc.PY/n.prof, row.names = NULL)\nnames(Doc.PY) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=Doc.PY, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"Scientific Production per Author\")\nprint(pobj)\n\n#' -------------------------------------\n#'\n#' # Colaboración\n#' ##  Índice de coautoria\n# an = 'Numero de autores'\n\nAuDoc.PY <- as.matrix(res2$AuDoc.PY[,-1])\nrow.names(AuDoc.PY) <- docs.ano\n\nkable(t(AuDoc.PY), digits = 2)\n\nplot(res2, 2)\n\n# ##  Documentos en colaboración nacional (pendiente)\n\n#' ##  Documentos en colaboración internacional\n\niadd <- get.idAddresses(db, Country != \"Spain\")\nidd <- get.idDocs(db, idAddresses = iadd)\n# summary(db,filter = idd)\n\nni.ano <- t(table(db$Docs$PY[idd]))\n\nkable(ni.ano)\n\nColInt <- data.frame(Types = factor(colnames(ni.ano)), Documents = as.numeric(ni.ano), row.names = NULL)\nnames(ColInt) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=ColInt, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"International Colaboration\")\nprint(pobj)\n\n#' -------------------------------------\n#'\n#' # Impacto na investigación\n#' ##  Citas recibidas\n# TC\tNúmero de veces citado de la Colección principal de Web of Science\n\nTC.PY <- as.matrix(res2$TC.PY[,-1])\nrow.names(TC.PY) <- docs.ano\n\nkable(t(TC.PY), digits = 2)\n\nplot(res2, 3)\n\n\n#' ##  Citas por profesor\nTC.PA <- TC.PY[, 1 , drop = FALSE] / n.prof\nkable(t(TC.PA), digits = 2)\n\nTCPA <- data.frame(Types = factor(rownames(TC.PA)), Documents = as.numeric(TC.PA), row.names = NULL)\nnames(TCPA) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=TCPA, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"Times Cited per Author\")\nprint(pobj)\n\n\n#' ###  Porcentaxe de documentos non citados\ncitas0 <- db$Docs %>% filter(TC==0) %>% count(PY)\ncitas0$n <- 100*citas0$n/drop(n.ano)\n\nTC.0 <- t(citas0[-1])\n\ncolnames(TC.0) <- as.character(citas0$PY)\nrownames(TC.0) <- \"Non Cited\"\nkable(TC.0, digits = 2)\n\nTC0 <- data.frame(Years = factor(colnames(TC.0)), Documents = as.numeric(TC.0), row.names = NULL)\nnames(TCPA) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=TC0, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"Non-Cited Documents\")\nprint(pobj)\n\n#' -------------------------------------\n#'\n#' # Visibilidade\n#' ##  Publicacións en revistas do primeiro cuartil\n#' ### Totais\np.q1 <- with(db$Docs, table(PY[Mellor.Cuartil == \"Q1\"]))\ntotp <- with(db$Docs, table(PY[!is.na(Mellor.Cuartil)]))\npq1 <- rbind(p.q1, round(p.q1/totp*100, 2))\nrownames(pq1) <- c(\"Total\", \"Proportions\")\n\nkable(pq1)\n\nPQ1<- data.frame(Years = factor(names(p.q1)), Documents = as.numeric(p.q1), row.names = NULL)\nnames(PQ1) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=PQ1, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"Q1 Publications\")\nprint(pobj)\n\n\n#' ##  Publicacións nas tres primeiras revistas de cada unha das áreas científicas\n#' ### Totais\n# Publicaciones en tres primeras revistas\n\np.3 <- with(db$Docs, table(PY[Posición.na.Discip2 < 4]))\np3 <- rbind(p.3, round(p.3/totp*100, 2))\nrownames(p3) <- c(\"Total\", \"Proportions\")\n\nkable(p3)\n\nP3<- data.frame(Years = factor(names(p.3)), Documents = as.numeric(p.3), row.names = NULL)\nnames(P3) <- c(\"Years\",\"Documents\")\npobj <- ggplot(data=P3, aes(x=Years, y=Documents, group=1)) +\n  geom_line(color=\"blue\")+\n  geom_point(color=\"blue\") + ggtitle(\"First Three Journals Publications\")\nprint(pobj)\n\n\n\n",
    "created" : 1515400853808.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3566005013",
    "id" : "EA760216",
    "lastKnownWriteTime" : 1515408111,
    "last_content_update" : 1515408111085,
    "path" : "C:/Users/Borja/Desktop/rwos_UDC_2007_2016.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 7,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}